---
# ansible-playbook edubox.yml -i <eduboxIPaddress>, --ask-become-pass

- name: apply configuration to the edubox
  hosts: all # eduboxes
  remote_user: ansible
  become: yes
  vars:
    contname: cont
    ## Password for the user 'ansible' in the container,
    ## leave empty to log in without password:
    contpwd: ""
    containers: "{{ range(0, 9 + 1) | list }}"
    extra_pkgs: [apt-cacher-ng]

  pre_tasks:
    - name: enable apt-cacher-ng
      lineinfile:
        path: /etc/apt/apt.conf.d/30proxy
        line: 'Acquire::http::Proxy "http://localhost:3142/";'
        create: yes

    - name: enable and start systemd-networkd on the host
      systemd:
        name: systemd-networkd
        state: started
        enabled: yes

  roles:
    - up2date-debian
    - educontainer
